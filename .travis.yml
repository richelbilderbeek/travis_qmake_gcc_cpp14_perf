language: cpp
compiler: gcc
sudo: require

before_install:
  # C++14
  - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
  - sudo apt-get update -qq

install: 
  # C++14
  - sudo apt-get install -qq g++-5
  # perf
  - sudo apt-get install linux-tools


script: 
  # Build
  - qmake
  - make release
  # Run
  - sudo perf record -g ./travis_qmake_gcc_cpp14_perf
  # Produce the perf log
  - perf report --stdio -g 'graph,0.5,caller' > perf.log
  # Show the perf log
  - cat parf.log
